@{
    ViewData["Title"] = "Qu·∫£n l√Ω Tasks";
    // Layout = "_Layout"; 

    // 1. D·ªÆ LI·ªÜU TH·ªêNG K√ä (Mock Data)
    var stats = new[] {
        new { Label = "T·ªïng task", Value = "52", Grad1 = "#667eea", Grad2 = "#764ba2", Icon = "M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" },
        new { Label = "Ho√†n th√†nh", Value = "32", Grad1 = "#f093fb", Grad2 = "#f5576c", Icon = "M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" },
        new { Label = "T·ª∑ l·ªá", Value = "62%", Grad1 = "#4facfe", Grad2 = "#00f2fe", Icon = "M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" },
        new { Label = "7 ng√†y t·ªõi", Value = "3", Grad1 = "#fa709a", Grad2 = "#fee140", Icon = "M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" }
    };

    // 2. D·ªÆ LI·ªÜU L·ªäCH (Ch·ªâ li·ªát k√™ c√°c ng√†y c√≥ task ƒë·ªÉ Demo, c√°c ng√†y kh√°c t·ª± ƒë·ªông sinh ra)
    // Sau n√†y b·∫°n s·∫Ω l·∫•y danh s√°ch n√†y t·ª´ Database SQL Server
    var daysWithTasks = new Dictionary<string, dynamic>
    {
        { "2025-11-01", new { Label = "1/2", Tasks = new[] { new { Title = "H·ªçp team bu·ªïi s√°ng", Done = true }, new { Title = "Vi·∫øt b√°o c√°o tu·∫ßn", Done = false } } } },
        { "2025-11-02", new { Label = "1/4", Tasks = new[] { new { Title = "G·ª≠i email kh√°ch h√†ng", Done = true } } } },
        { "2025-11-03", new { Label = "2/2", Tasks = new[] { new { Title = "Ki·ªÉm tra inventory", Done = true }, new { Title = "Book kh√°ch s·∫°n", Done = true } } } },
        { "2025-11-04", new { Label = "2/3", Tasks = new[] { new { Title = "ƒê·∫∑t v√© m√°y bay", Done = true }, new { Title = "Review code", Done = false } } } },
        { "2025-11-05", new { Label = "1/3", Tasks = new[] { new { Title = "Meeting v·ªõi kh√°ch h√†ng", Done = false } } } },
        { "2025-11-06", new { Label = "1/2", Tasks = new[] { new { Title = "Thanh to√°n h√≥a ƒë∆°n", Done = true }, new { Title = "Update website", Done = false } } } },
        { "2025-11-08", new { Label = "2/3", Tasks = new[] { new { Title = "Ki·ªÉm tra cao t√†i...", Done = true } } } },
        { "2025-11-09", new { Label = "0/1", Tasks = new dynamic[0] } }
    };
}

<div class="main-content">
    <div class="page-header">
        <div class="header-top">
            <h1 class="page-title"><span>üìÖ</span> Tasks</h1>
            <div class="header-actions">
                <button class="btn btn-secondary">
                    <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
                    </svg> L·ªçc
                </button>
                <button class="btn btn-primary" onclick="SecureNotes.openAddTaskModal()">
                    <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
                    </svg> Th√™m Task
                </button>
            </div>
        </div>

        <div class="search-bar">
            <svg class="search-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
            <input type="text" class="search-input" placeholder="T√¨m ki·∫øm tasks..." id="searchInput" />
        </div>
    </div>

    <div class="stats-grid">
        @foreach (var stat in stats)
        {
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, @stat.Grad1 0%, @stat.Grad2 100%);">
                    <svg width="24" height="24" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="@stat.Icon" />
                    </svg>
                </div>
                <div class="stat-content">
                    <div class="stat-label">@stat.Label</div>
                    <div class="stat-value">@stat.Value</div>
                </div>
            </div>
        }
    </div>

    <div class="calendar-container">
        <div class="calendar-header">
            <button class="btn btn-secondary btn-icon">
                <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" /></svg>
            </button>
            <h2 class="calendar-title">Th√°ng 11 2025</h2>
            <button class="btn btn-secondary btn-icon">
                <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" /></svg>
            </button>
        </div>

        <div class="calendar-grid">
            <div class="calendar-weekday">Th·ª© 2</div>
            <div class="calendar-weekday">Th·ª© 3</div>
            <div class="calendar-weekday">Th·ª© 4</div>
            <div class="calendar-weekday">Th·ª© 5</div>
            <div class="calendar-weekday">Th·ª© 6</div>
            <div class="calendar-weekday">Th·ª© 7</div>
            <div class="calendar-weekday">Ch·ªß nh·∫≠t</div>

            @{
                DateTime startDate = new DateTime(2025, 10, 27);
                for (int i = 0; i < 21; i++)
                {
                    DateTime currentDate = startDate.AddDays(i);
                    string dateString = currentDate.ToString("yyyy-MM-dd");
                    string dayNumber = currentDate.ToString("dd/MM");
                    
                    // X√°c ƒë·ªãnh CSS class cho ng√†y
                    string cssClass = "calendar-day";
                    if (currentDate.Month == 10) cssClass += " past";
                    if (currentDate.ToString("yyyy-MM-dd") == "2025-11-06") cssClass += " active";
                    
                    // Ki·ªÉm tra xem ng√†y n√†y c√≥ Task kh√¥ng
                    bool hasTask = daysWithTasks.ContainsKey(dateString);
                    if (hasTask) cssClass += " has-tasks";

                    <div class="@cssClass" data-date="@dateString">
                        <div class="day-number">@dayNumber</div>
                        
                        @if (hasTask)
                        {
                            var dayData = daysWithTasks[dateString];
                            <div class="day-label">@dayData.Label</div>
                            
                            foreach (var task in dayData.Tasks)
                            {
                                <div class="task-preview">
                                    <div class="task-dot @(task.Done ? "completed" : "")"></div>
                                    <span>@task.Title</span>
                                </div>
                            }
                        }
                    </div>
                }
            }
        </div>
    </div>

    <div id="taskModal" class="modal" style="display: none">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Chi ti·∫øt Task</h3>
                <button class="modal-close" onclick="document.getElementById('taskModal').style.display='none'">&times;</button>
            </div>
            <div class="modal-body">
                </div>
        </div>
    </div>
</div>